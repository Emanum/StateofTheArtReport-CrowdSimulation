%%
%% This is file `sample-xelatex.tex',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% samples.dtx  (with options: `sigconf')
%% 
%% IMPORTANT NOTICE:
%% 
%% For the copyright see the source file.
%% 
%% Any modified versions of this file must be renamed
%% with new filenames distinct from sample-xelatex.tex.
%% 
%% For distribution of the original source see the terms
%% for copying and modification in the file samples.dtx.
%% 
%% This generated file may be distributed as long as the
%% original source files, as listed above, are part of the
%% same distribution. (The sources need not necessarily be
%% in the same archive or directory.)
%%
%% The first command in your LaTeX source must be the \documentclass command.
\documentclass[sigconf]{acmart}

%%
%% \BibTeX command to typeset BibTeX logo in the docs
\AtBeginDocument{%
  \providecommand\BibTeX{{%
    \normalfont B\kern-0.5em{\scshape i\kern-0.25em b}\kern-0.8em\TeX}}}

%% Rights management information.  This information is sent to you
%% when you complete the rights form.  These commands have SAMPLE
%% values in them; it is your responsibility as an author to replace
%% the commands and values with those provided to you when you
%% complete the rights form.
\setcopyright{acmcopyright}
\copyrightyear{2020}
\acmYear{2020}
\acmDOI{10.1145/1122445.1122456}

%% These commands are for a PROCEEDINGS abstract or paper.
\acmConference[Scientific Research and Writing]{Scientific Research and Writing 2020S Part 2 with CG-Group}{2020S}{TU Vienna}
\acmBooktitle{Scientific Research and Writing 2020S Part 2 with CG-Group - Crowd Simulation}
\acmPrice{42,42}
\acmISBN{978-1-4503-XXXX-X/18/06}


%%
%% Submission ID.
%% Use this when submitting an article to a sponsored event. You'll
%% receive a unique submission ID from the organizers
%% of the event, and this ID should be used as the parameter to this command.
%%\acmSubmissionID{123-A56-BU3}

%%
%% The majority of ACM publications use numbered citations and
%% references.  The command \citestyle{authoryear} switches to the
%% "author year" style.
%%
%% If you are preparing content for an event
%% sponsored by ACM SIGGRAPH, you must use the "author year" style of
%% citations and references.
%% Uncommenting
%% the next command will enable that style.
%%\citestyle{acmauthoryear}

%%
%% end of the preamble, start of the body of the document source.
\begin{document}

%%
%% The "title" command has an optional parameter,
%% allowing the author to define a "short title" to be used in page headers.
\title{State of the Art Report - Crowd Simulation}

%%
%% The "author" command and its associated commands are used to define
%% the authors and their affiliations.
%% Of note is the shared affiliation of the first two authors, and the
%% "authornote" and "authornotemark" commands
%% used to denote shared contribution to the research.
\author{Manuel Eiweck}
\affiliation{
	\institution{Student of Technical University Vienna}
}
\email{e1633012@student.tuwien.ac.at}

%%\author{Bernhard Kerbl}
%%\affiliation{
%%	\institution{Institute of Visual Computing \& Human-Centered Technology, Technical University Vienna}
%%}
%%\authornote{Advisor}
%%\email{kerbl@cg.tuwien.ac.at}

%%
%% By default, the full list of authors will be used in the page
%% headers. Often, this list is too long, and will overlap
%% other information printed in the page headers. This command allows
%% the author to define a more concise list
%% of authors' names for this purpose.
\renewcommand{\shortauthors}{Manuel Eiweck}

%%
%% The abstract is a short summary of the work to be presented in the
%% article.
\begin{abstract}
The goal of this state of the art report is to give an broad overview of the topic and act as a starting point to readers who are completely new to the field. As crowd simulation is a wide field with different research communities, it is not possible to mention all approaches to the challenges this area faces, so the report focus on the challenges themselves and describe the idea behind common approaches. In addition there are references to different papers which either directly cover the approaches or literature which summarize the research in more detail.

In the Introduction the research procedure, the two key areas, simulation models and often used terms are explained, additionally some elementary and often cited papers are described in more detail as they show the foundation of crowd simulation. The Report continues with an overview of application areas and where the research is applied with given real world examples. After that the research areas and problem these face are described in more detail. Lastly the report covers some promising algorithms and approaches in more detail as an example of recent published papers on the field. 
TODO: finalize intro after finished report
\end{abstract}

%%
%% The code below is generated by the tool at http://dl.acm.org/ccs.cfm.
%% Please copy and paste the code instead of the example below.
%%
\begin{CCSXML}
<ccs2012>
<concept>
<concept_id>10010147.10010371.10010352</concept_id>
<concept_desc>Computing methodologies~Animation</concept_desc>
<concept_significance>500</concept_significance>
</concept>
<concept>
<concept_id>10010147.10010371.10010352.10010381</concept_id>
<concept_desc>Computing methodologies~Collision detection</concept_desc>
<concept_significance>500</concept_significance>
</concept>
<concept>
<concept_id>10010147.10010371.10010352.10010379</concept_id>
<concept_desc>Computing methodologies~Physical simulation</concept_desc>
<concept_significance>100</concept_significance>
</concept>
<concept>
<concept_id>10010147.10010371.10010352.10010378</concept_id>
<concept_desc>Computing methodologies~Procedural animation</concept_desc>
<concept_significance>500</concept_significance>
</concept>
<concept>
<concept_id>10010147.10010341.10010370</concept_id>
<concept_desc>Computing methodologies~Simulation evaluation</concept_desc>
<concept_significance>300</concept_significance>
</concept>
<concept>
<concept_id>10010147.10010341.10010349.10010359</concept_id>
<concept_desc>Computing methodologies~Real-time simulation</concept_desc>
<concept_significance>500</concept_significance>
</concept>
<concept>
<concept_id>10010147.10010341.10010349.10010362</concept_id>
<concept_desc>Computing methodologies~Massively parallel and high-performance simulations</concept_desc>
<concept_significance>500</concept_significance>
</concept>
</ccs2012>
\end{CCSXML}

\ccsdesc[500]{Computing methodologies~Animation}
\ccsdesc[500]{Computing methodologies~Collision detection}
\ccsdesc[100]{Computing methodologies~Physical simulation}
\ccsdesc[500]{Computing methodologies~Procedural animation}
\ccsdesc[300]{Computing methodologies~Simulation evaluation}
\ccsdesc[500]{Computing methodologies~Real-time simulation}
\ccsdesc[500]{Computing methodologies~Massively parallel and high-performance simulations}

%%
%% Keywords. The author(s) should pick words that accurately describe
%% the work being presented. Separate the keywords with commas.
\keywords{crowd simulation, state of the art report}

%% A "teaser" image appears between the author and affiliation
%% information and the body of the document, and typically spans the
%% page.
\begin{teaserfigure}
  \includegraphics[width=\textwidth]{sampleteaser}
  \caption{Seattle Mariners at Spring Training, 2010.}
  \Description{Enjoying the baseball game from the third-base
  seats. Ichiro Suzuki preparing to bat.}
  \label{fig:teaser}
\end{teaserfigure}

%%
%% This command processes the author and affiliation and title
%% information and builds the first part of the formatted document.
\maketitle

\section{Introduction}

A good comprehensive work on crowd simulation is the book "Crowd Simulation" \cite{thalmann_crowd_2013} in the introduction part I will sum up some key aspects. 

The research results in crowd simulation does not come from one or two specific scientific fields or communities, rather the results is a combination of many different fields. A big part comes from the computer graphics field but there is also research done in architecture, physics, robotics, safety science and sociology because these face similar problem. A resulting problem is that it is difficult to keep up to date with the current research, maybe overlook some new important papers on different fields and miss useful information for the own research. In addition most papers are presenting an solution for a specific problem or use case, for example a pedestrian simulation in real time \cite{karamouzas_predictive_2009},which is not very useful when you want to simulate a big fighting scene in a movie.

\subsection{Key areas}
\label{chap:key_areas}
For a believable crowd simulation there are two parts. First we need to have \textbf{an realistic crowd behavior model, animation and environment modeling"} which defines how the crowd is moving and reacting to each other and the environment. Some example research papers here are for example "Flocks, herds and schools: A distributed behavioral model"\cite{reynolds_flocks_1987} or "Social force model for pedestrian dynamics"\cite{helbing_social_1995}. Second we also need \textbf{crowd rendering} for displaying the large amount of simulated persons in the crowd in a convincing manner with matching animations, where performance is especially important in real time simulations. Here an example is "Geopostors: a real-time geometry / impostor crowd rendering system"\cite{lee_crowd_2018}. Both areas are important as a they depend on each other to deliver an credible crowd simulation.

Most application on crowd simulation focus on one of two key areas: 
\begin{itemize}
\item \textbf{Realism of behavioural simulation:} The focus is to reproduce real crowds as close as possible. Crowd dynamics, movement, collision avoidance, independent decisions and simulation result evaluation are some keywords in this area. Example applications would be pedestrian and traffic simulation in urban areas especially at evacuation scenarios or big events or public buildings.
\item \textbf{High quality rendering:} Here the focus lies on producing stunning videos with crowd simulation components, the behavior of the crowd should not always match reality here instead the animator decide based on creative decisions. Example applications are found in the form of plugins for 3D graphic software like "Autodesk Maya" or "Blender", libraries in pc or console games and finally as proprietary render engines and tools for movie blockbusters.
\end{itemize}

\cite{thalmann_crowd_2013}

\subsection{Simulation Models}
\label{chap:simulationModels}
To simulate realistic crowd behavior a model is needed which specifies how the crowd reacts in each simulation step. The used models can be classified in roughly two groups macroscopic and microscopic models. The difference is how they see an agent in a crowd. An \textbf{agent} is a single actor in a crowd simulation which can move and act independently from other agents, this can be a human in a crowd of people but also a car in a traffic simulation. However on some applications and paper especially those who handle real time simulations agents are grouped to reduce the simulation cost and only rendered as multiple agents / persons, an example are the "TotalWar" \cite{total_war_website} \cite{thalmann_crowd_2013} game series.

\subsubsection{\textbf{macroscopic models}}
These types of models try to simulate the crowd as an whole unit, they are often used in a real-time scenario because the number of individual agents in the crowd does not highly affect performance in the simulation. In some papers they are also referred as "continuum-based"\cite{xu_crowd_2014}. The goal here is that the crowd as a whole reacts realistically. These simulation can be compared to gas or fluid simulations, because there is not each particle or in our case each agent simulated moreover there is a common path for the fluid or whole crowd simulated. An example are the pedestrian and crowd simulation papers from Hudges \cite{hughes_continuum_2002} \cite{hughes_flow_2003}

\subsubsection{\textbf{microscopic models}} \label{def:microscopic models}
On the other hand microscopic models, also referred as "agent-based"\cite{xu_crowd_2014} try to simulate each single agent. The resulting simulation often brings better results than a simulation with a macroscopic model but it also costs more performance, so it is not suitable for simulating large crowds in real time. Most approaches define rules for each agent how to react to the environment and different scenarios. There is a lot of different papers and approaches which rules and attributes provide what results. A common used approach is force-based, famous cited papers are "Social force model for pedestrian dynamics" \cite{helbing_social_1995} and "Flocks, herds and schools: A distributed behavioral model" \cite{reynolds_flocks_1987}. 

\cite{xu_crowd_2014}\cite{thalmann_crowd_2013}

\subsection{elementary papers}
\label{chapter:elementaryPapers}
In the following section i want to sum up some often cited and elementary papers for crowd simulation. 
\subsubsection{Flocks, herds, and schools: A distributed behavioral model.}\cite{reynolds_flocks_1987}
is one of the most famous first published papers for the field. The paper describes an approach for modeling a simulation of a flock of birds and other crowds. At that time the common way to simulate a crowd would be to script the path of each agent individually. Reynolds defined some key concepts and keywords for the crowd simulation field for example he introduced the idea of what later would become known as agend-based or microscopic simulation:
\begin{quote}
"Yet all evidence indicates that flock motion must be merely the aggregate result of the actions of individual animals, each acting solely on the basis of its own local perception of the world. (...) This approach assumes a flock is simply the result of the interaction between the behaviors of individual birds. To simulate a flock we simulate the behavior of an individual bird (...)"
\end{quote}
He also compares his approach to a particle system for simulating dynamic "fuzzy objects", but the differences in his approach is that each particle/bird has a complex geometrical state (orientation, animation for example flight banking) and that a bird flock is more complex to describe than other particle systems like for example a fire, in addition basic particle systems do not simulate the interaction between the particles.  
\begin{quote}
"Boid behavior is dependent not only on internal state but also on external state"
\end{quote}
He uses the term \textbf{actor} as "computational abstraction that combines process, procedure, and state." This is still relevant because most microscopic simulation approaches use a similar concept for abstracting the simulation system from the actual application, here a bird flock.  
In addition there is also a chapter on how flocks are interacting with another. An interesting statement is: 
\begin{quote}
"birds can flock with any number of flockmates because they are using what would be called in formal computer science a constant time algorithm. "
\end{quote}
The reason for this is that the birds does not include all other individual birds for their decision making, instead they only rely on itself, the nearest neighbors and a filtered perception on the rest of the flock. This  filtering of  information is also seen on other papers which cover level of detail in crowd simulations \cite{osullivan_levels_2002}. Of course in a computer simulation there will always be a limit for a maximum of individual agents as the computing resources are limited. 

The paper continues with more information about the aspects of what to consider when rendering crowds with the example of the bird flock and other animal crowds. Many of these aspects and problems are still relevant in current papers that is the reason why this an important elementary paper in the crowd simulation field, however when it comes to details in the implementation of the algorithm there are more up to date approaches. 

\subsubsection{Social force model for pedestrian dynamics}\cite{helbing_social_1995} is an important paper when it comes to pedestrian simulation for common daily tasks, these crowd flow simulations are used in the architectural field in planning state for large buildings train station, airports, shopping centers etc.. 
\begin{figure}[h]
  \centering
  \includegraphics[width=1\linewidth]{images/helbingSocialForceConceptScheme.png}
  \caption{sequence of actions in the social force concept, taken from \cite{helbing_social_1995}}
  \Description{sequence of actions in the social force concept}
  \label{fig:helbingSchema}
\end{figure}
Fig. \ref{fig:helbingSchema} shows the sequence of actions lead to the an action for an individual crowd agent, based on research done by Lewin \cite{lewin_field_1951}. The Stimulus is used as an trigger like someone is blocking the way, this results in the process of handling the situation which creates an motivation to act and in the final form a reaction which is carried out. This concept can be applied to all situations, Helbing however describes a model for common situations which are decided usually automatically and intuitively by the person. The idea is to describe the pedestrian movement indirectly through describing the external forces which affects the agent. 
Helbings social force model uses 3 main effects for the model:
\begin{enumerate}
    \item the goal for the person is to reach some sort of target destination as easy as possible, usually the fasted route.
    \item "repulsive effect", the pedestrian wants to "keep a certain distance from other pedestrians that depends on the pedestrian density and the desired speed". In addition the pedestrian also want to keep distance to borders.  
    \item "attracted effect", the pedestrians " are sometimes attracted by other persons (friends, street artists, etc.) or objects (e.g., window displays)."
\end{enumerate}
In the paper all effects are described in detail with mathematically equations, these are not displayed here for reasons of clarity. The result movement decision is the sum of all effects plus a fluctuation term for situations where two alternatives are rated equally. Simulations with this models shows:
\begin{quote}
    "(i) the development of lanes consisting of pedestrians who walk into the same direction and (ii) oscillatory changes of the walking direction at narrow passages."
\end{quote}
This behaviour can also be observed in real world scenarios. 

\subsubsection{Simulating dynamical features of escape panic}\cite{helbing_simulating_2000} on the other hand there is also a need for simulating pedestrians in a panic situation, a common example are evacuation simulations.
There are a number of reasons for a panic reaction in a crowd, unexpected actions like an loud gun shot or a fire are a common reasons most people would think about. But also expected situations like the race for a limited amount of resources (tickets, seats, toilet paper in the corona crisis)  and even situations without any cause at all can cause a crowd panic. These panic reactions often lead to tragic events and cause harm to people seen for example on the panic at the loveparade 2010 \cite{dumbs_massenpanik_2010} . That events also show that the reaction of the individual agent is way more complex in a panic situation than under normal circumstances, this makes the development for a crowd behavioural model of course difficult, in addition the paper also states that there is not enough suitable data to test their panic model as they obviously can't simple produce a panic in the real world. 

The paper gives an definition of features of a panic situation, some of them are (1) People move faster than normal (2) People start pushing and so on, the whole list is described in the paper. They use these features to construct a behaviour model based on the "generelized force model"\cite{hindsley_investigation_1986}
\begin{quote}
"We assume a mixture of psychological and physical forces influencing the behaviour in a crowd"
\end{quote}
Again the mathematically details are not displayed here for reasons of clarity. They also ran a number of different tests with the model, the results show the following:
\begin{itemize}
\item "Transition to in-coordination due to clogging" In a situation where the crowd want to exit an area trough a small gap, the number of people leaving get smaller when the velocity of the crowd increases.
\item "Faster-is-slower effect due to impatience", clogging can appear also when there is a wider gap in the escape route. 
\item "Mass behaviour" Here the goal was to leave a room with smoke in it, results showed that the quickest evacuation would be possible when there is an equal mixture of individualistic and herding behaviour. 
\end{itemize}
In their model they have a "panic parameter" \label{term:panicParameter} which allows to adjust the "amount" of panic in comparison to a normal daily situation. Because the results are also observed in real crowd panics, their model is often used as a base for a number of other evacuation simulation papers. \cite{braun_simulating_2005} \cite{zheng_modeling_2009}

\section{Application Areas}

As the research field for crowd simulation is already wide spread over multiple science fields and communities the resulting application areas are of course too. The applications can be roughly grouped by the key areas mentioned before \ref{chap:key_areas}. 

\subsection{realism focused simulation}

In the area of realism focused simulation pedestrian and traffic simulation plays a big role, as these are used to simulate large urban areas. There are a number of commercial available software for similar use-cases like simulating the crowd flow on events, public transport buildings, airports and even cruise ships and whole city districts. They often come with extended features which goes beyond the crowd simulation like heat-maps, smoke simulation, integration for 3D models and other CAD applications, recording and playback and so on. The customers for these applications are public transport companies, architectural offices, event organizers and the public governance sector. The simulation allows them to reduce costs in the planning phase and optimize their infrastructure, simulation of the evacuation times required is also a market for these applications.  Some example Applications are "Pedestrian Dynamics®" \cite{pedestrian_dynamics_pedestrian_2020}, "MassMotion"  \cite{mediaworks_pedestrian_2020} and "Anylogic" \cite{anylogic_website}

\begin{figure}[h]
  \centering
  \includegraphics[width=1\linewidth]{images/PedestrianDynamicsStadionExample.png}
  \caption{example visualization of a pedestrian flow in the commercial software "Pedestrian Dynamics®",  taken from \cite{pedestrian_dynamics_pedestrian_2020}}
  \Description{example visualization of a pedestrian flow in a stadium}
  \label{fig:stadionEvacuationExample}
\end{figure}

Although the visual presentation is not the focus of these applications it does not necessarily have to look basic. As some of the introduced commercial tools also have export functions for the generated behaviour especially the movement, these exports can be used later to produce visual appealing videos in 3D applications like "3ds Max" as a demo of Jordan Lynam shows us. \cite{lynamJordan_viissim_3ds_max}

\subsection{High quality focused simulation}

On the other hand we have the visual focused applications, in comparison to the realism focused simulation application the amount of public available applications and research is rare and hard to find. The reason for this is that, especially the applications used for movies, are highly proprietary and not published. Most of the time information is only available in the form of making-of documentaries, interviews and CGI trailers. 
However the foundation, these applications are based on, is usually public available in the form of scientific papers. The challenges these applications are confronted with are strongly influenced by the crowd rendering research field, especially in games as these require real-time simulations. \cite{thalmann_crowd_2013}

\subsubsection{Movies}

There are multiple benefits of crowd simulation for movies and other types of creative video content, an nearly endless amount of possible scenes and shots can be created, for example an huge battle or a populated city. Some scenes would just not be able to be animated manually with CGI not to mention to hire an amount of actors and actually film it. In comparison to the realism focused applications, simulations on movies does not have the strong urge of proper continuous crowd behavior as movies are grouped in shots where the viewer often don't see the same part of the crowd for a longer time period. Lastly creative content obviously don't always want realistic behaving crowds, animators see crowd simulation more as a tool for controlling large crowds, so the research field for manipulation of crowds is also an important aspect on movie crowd simulation,  examples are \cite{kim_interactive_2014} \cite{ulicny_crowdbrush_2004}

In the recent movie "THE HOBBIT: Battle of Five Armies" there were  two types of crowd simulation tools used, "Massive" one of the most advanced non-real-time simulation tools \cite{massive_website} for rendering the final scenes in post production, which at this scale requires render farms for weeks or even months to finish. Therefore a second tool "army-manager" was used earlier in the production as this could render much faster and allowed the visual effects team to plan their shots and get a draft of the final simulated crowd. \cite{wired_hobbit_doku}

On the example of the movie "World War Z" we can also see that the simulations are often combined with a database of motion captures scenes, we already saw that approach at some literature \cite{thalmann_crowd_2013}, and rigid body physics. In addition the "Alice" program which is used to simulate the zombie crowds, uses an microscopic based model where each agent is simulated by given rules and attributes, which we already know from a lot of papers. \cite{wired_worldwarz_doku} 

An other commercial software for CGI crowds is "Golaem" \cite{golaem_website}. This software can be purchased for individual projects and is therefore used for movies with a smaller budget, commercials or other short CGI clips in need for crowds, which can't afford to develop an own software tool, but it is also used for big budget production of example in "Game of Thrones" \cite{golaem_got_vid}

\cite{thalmann_crowd_2013}
\subsubsection{Games}

As games and other interactive media are real-time simulations they have limited capabilities for costly simulations, so crowd simulations are not so common in today's games. One game genre that uses them are real-time strategy games like Total War \cite{total_war_website}, where the crowd simulation can also have an effect on the gameplay and not only used to render visually appealing large crowds. 
Many approaches for real time simulation is used one common used technique is the LOD (level of detail) for the rendering of the crowd and also for the simulation it self. However LOD is more complex when used on the actual crowd behaviour simulation than on the crowd rendering itself, there is always the danger of getting an wrong simulated world when the simulation detail level is too low. Another common used trick is to render one simulated agent as multiple persons to simulate a crowd. Lastly as games are usually run on a powerful GPU, real time crowd simulation can also benefit from that, especially the rendering part is good manageable by the GPU. \cite{thalmann_crowd_2013}

An example of what can be done with various optimization is "Ultimate Epic Battle Simulator" \cite{ultimeEpicBattleSim_video} , which is basically a big real-time crowd simulation sandbox. They manage to simulate path tracing on up to ten thousands of individual soldiers in real time. 
\begin{quote}
"The algorithm is a highly optimized version of A*.  \label{term:A*Usage} The memory is shared, but the paths are not." \cite{ultimeEpicBattleSim_video}
\end{quote} This example shows that crowd simulation at games comes with a big trade off for performance. 

\section{Research Areas}

The rough separation of the research field described in \ref{chap:key_areas} can be extended for more detail. \cite{thalmann_crowd_2013}

\subsection{Crowd behavior generation}

An automated model which animates the crowd movement is the core component for crowd simulation. Here the goal is that our agents does not need to be animated manually where to go and how to interact with each other. The creator of the animation only provides some goals, for example escape from the building and sets parameters like the "panic parameter" see \ref{term:panicParameter}. We already talked about some important aspects of that field in \ref{chap:simulationModels} and \ref{chapter:elementaryPapers}.  In this research area there are a lot of different approaches and the problem of application specific algorithms is here bigger than in other areas.

In the following i want to describe the different challenges we face in this area:


\subsubsection{Behavioral model}
We want a realistic crowd behavioral model for our specific use case which does not cost much performance and at the same be adaptable so that the creator of the simulation is still able to control the crowd from an wider point of view. The model has to control how the individual agents gather in small groups and interact with each other for example there can be multiple types of crowd agents a leader, follower and people who want to walk alone are some examples which can be adapted for the application specific needs. Some example models here are \cite{musse_hierarchical_2001} for real time applications and \cite{braun_simulating_2005} for non real time evacuation applications, the selection of a model depends on the actual application and its individual needs.


\subsubsection{Crowd navigation}
Deals with the motion planning of a path from the beginning position to the goal position the agents have to reach in the long term. Some research here comes from the robotics field as these share similar problem like \textbf{collision avoidance and path planning}. However the algorithms have to be adapted for use in crowd simulations as there are additional challenges like performance. To circumvent this the path planning is done with abstract graphs, some of them are "grid graph", "point graph", "Navigation mesh / visibility graph", "Probabilistic roadmaps", "Rapidly exploring randomized trees" and "Voronoi diagrams". After modeling graph search algorithms are run to plan the path to the goal these include "Breadth-ﬁrst search (BFS)",  "Depth-ﬁrst search (DFS)", "Dijkstra’s algorithm", "A* algorithm" used in \ref{term:A*Usage} and hybrid approaches. An detailed overview for the here explained graphs and algorithms can be found in the state of the art report of \cite{jaros_crowd_2014}. 

\subsubsection{Collision avoidance}
Collision Avoidance algorithms have to be used to prevent collisions between the dynamic environment (cars, collapsing building) and the individual agents each to other. The challenge is that we don't know the velocity and direction each collision object will move in the future, and communication is usually not possible. A common approach is to predict the future movement through extrapolation \cite{karamouzas_predictive_2009}. Another would be to use vision-based approach \cite{ondrej_synthetic-vision_2010}.


\subsubsection{Additional behaviors}
For a realistic looking crowd there are often more animations than the core walking animation needed. Some papers for example research gaze animations and eye movement. 

\subsection{Generation of individual agents}
To simulate a realistic crowd it is necessary to have different 3D models to display in our crowd. The goal in this area is to develop methods which reduce the cost of time to create such models. There are multiple approaches which i want to give an quick overlook. Which approach to choose depends on multiple aspects like quality needed, amount of time which can be invested, what type of agents to produce (persons, cars, ...) and many more. 
\subsubsection{manually model agents}, the most basic way is of course to model each agent manually. The challenge is to also keep the polygon count low as this is required later on when we want to render the crowd. Techniques like subdivision modeling and patch modeling are used to achieve that.
\subsubsection{reconstruct from existing data}, another approach is to use already existing data in the form of videos, a photo series or a 3D Scan from agents we want to simulate. Hole filling, noise reduction and skeleton hierarchy approximation are some challenges this approach faces in the process of finalizing the models. 
\subsubsection{interpolate existing models}, on some cases there are already models available to use, of course these can also come from the approaches mentioned before. We can use these models to interpolate between multiple models to create new ones. Some papers also construct a template agent which can be used to generate models with given parameters (height, body type, ...)
\subsubsection{auto generated models from population}, an optimum would be to generate a large amount of diverse looking agents with as little information as possible, this idea is the goal for that methods. However it is rather hard to create models that can compete against models from other approaches, one promising approach is the "somatotype model". It uses multiple extreme somatotypes and tries to generate models in between them. The demand for efficient result analysis, to evaluate the generated models is another challenge. This is done with microscopic analysis, for testing the appearance to the input data and macroscopic analysis for testing the diversity of generated models. 
\subsubsection{computer vision}, is also another approach to generated customized models. This allows the user to generate a model based on an image, it is used in some games in the character creation process. 
\subsubsection{vary model for large crowds}, one problem with all approaches is that they only work for a limited amount of agents effectively. To prevent the use of nearly similar looking agents and to reduce the memory needed for storing and later also rendering the agents it is possible to vary the generated models. This can be done on multiple levels like skeleton, meshes, textures and animations. 
\cite{thalmann_crowd_2013}

\subsection{Crowd animation}

After the generation of different models for our crowd we want to bring some life to it by animation. Some aspects we have to consider when creating animations are that they should not take much computational cost,  be able to scale for a large amount of actors, allow level of detail gradation and provide a diverse select of possible matching. The animation consists of primary movements and secondary, when we take a person walking animation as example the actual walking would be the primary and other movements like hand gestures or phone interaction the secondary.
A often used approach is the use of an animation database, that is precalculated and can be used in the simulation later on. The database can be filled using locomotion cycles with procedural modeling or with motion capture of real animations. In the case of motion capture a statistical model can be calculated which allows to produce a locomotion model. For more details see \cite{thalmann_crowd_2013}

\subsection{Interaction with virtual crowds}

Another area is researching how information from real crowds could be used to optimize the crowd behavior for the virtual crowds. In the basic form people are observing real crowds and evaluate these results empirical to detect common patterns. These found patterns are later tried to generalise in the form of individual, group and sociological aspects which can be implemented in the behaviour models of applications to provide accurate representation of the real world. To the individual aspects count behavior as personal/individual space and communication between individuals. Social conventions, group formation and leader selection are examples for group aspects. Sociological aspects describe behavior between a group and individuals, polarization, domination and the loss of individuality's are some examples.  

In addition the automatic information gathering using computer vision is also part of this research field. The benefit of using these techniques is that first it is way less time consuming than manual observation and second that the infrastructure needed is quite cheap and often already available in the form of security cameras on public places. The information extraction is not just limited to person movement, a simple motion capture for the use in animation is also possible or detection of events and their reactions, for example the persons reaction when an train is entering the platform. One example pipeline \cite{thalmann_crowd_2013} presented could be 1) extract trajectory for every person 2) group trajectories into "motion clusters" 3) compute an velocity field for each cluster 4) use these velocity fields in the virtual crowd simulation. 

\cite{thalmann_crowd_2013}

\subsection{Crowd rendering}

This area mainly deals with the technical details on how to render a large amount of individual agents especially in real time applications this is a big challenge. In Addition the quality of the agents also have to match the application, storage and data have to be managed  efficiently and lastly our process has to be adaptable to different environments and situations. 
\cite{beacco_survey_2016} provides an good overview of the common used approaches dealing with these problems. They pointed out "that the rendering process is strongly tied to the simulation process and also to animation computations.". So to render an crowd in real time the other steps also have to be efficient enough to be calculated in real time.  

An important and often used approach is to use different levels of detail (LoD) for our final rendering, we already saw that approach in the form of simulation detail levels.\cite{osullivan_levels_2002}. However the goal of LoD in crowd rendering is to render different agents with different detail representations based on the importance of the agent in the current rendering frame. Usually the different levels are prepared beforehand and the decision what level to use is done at runtime. For character crowds polygon based approaches are usually used, multiple 3D models are used here. Other techniques for LoD are point-based where agents far in the distance are only represented as a point and therefore don't require any geometry and image-based also knows as impostors use simple primitives with textures to fool the viewer, the primitives can be a simple billboarding technique or more complex shapes. In a complete application there will usually be an hybrid approach which combines multiple LoD techniques, the challenge here is to prevent flickering when the LoD or technique switches. 

Additionally crowd rendering can also benefit from other performance techniques used in other rendering areas, these focus mostly on an optimum use of the GPU and current hardware features. View frustum culling is one of them, which allows to exclude some agents from the rendering in the first place as these are hidden by other geometry or aren't even in the camera view anyway. A special case in crowd rendering is that not only static geometry can block the sight to an object but also an large amount of agents in one place. Some other techniques are primitive instancing, palette skinning and key-pose caching.     
\cite{beacco_survey_2016}

\cite{thalmann_crowd_2013}

\subsection{Generation of environments for crowds}

Here the research is focused to produce areas for the crowd simulation, as most application simulate people crowds around cities the automatic construction of urban areas is a big research topic. The research done here range from terrain modeling, plants-, lakes- and building placements over building floor plans and streets. It is important to remember that the generated environment also infects our whole simulation (path planning, collision avoidance, behaviour model, ...). 
As modelling these often large areas manually requires a lot of time the need for automatic or semiautomatic algorithms is big. A rough separation of these methods are reconstruction based and parametric based approaches. 
Aerial photos, 2D maps and laser profiler data is used to reconstruction real world environments. This applications are usually applied at historically cities. 
On the other hand parametric methods does not focus on the accurate representation of already existing areas, moreover they want to provide cities for specific use cases where the application can decide on the parameters these later can be filled with the crowd.  Another important aspect is that the environment has to be interactive, for example  crowd agents should be able to enter buildings.
\cite{thalmann_crowd_2013}

\section{concrete example papers}

In the last chapter i want to present some concrete example researches in the crowd simulation field. 

\subsection{HiDAC System}

The paper "Controlling Individual Agents in High-Density Crowd Simulation" \cite{pelechano_controlling_2007} is an interesting example because it combines multiple simulation models and algorithms to simulate a crowd in one system, which they call High-Density Autonomous Crowds (HiDAC) system. They focus on delivering a simulation which produces realistic crowds.
In addition this papers also shows what aspects are to consider and how to design a simulation model.

The initial problem is that there was no simulation model which can handle high-density crowds realistically. They want to combine the advantages of rule based and social force based models without their disadvantages.

\subsubsection{architecture and goals}
HiDAC is an agent based or microscopic simulation \ref{def:microscopic models}, so there is no higher system which controls the flow of the crowd, each agent acts on its own.
Fig. \ref{fig:hidacArchitecture} shows the two main modules of the system. The high-level module is responsible for long term tasks like wayfinding by choosing attractor points for each agent. Other more detailed or spontaneous tasks are done by the low-level module like collision avoidance to other agents  within a bounded space.
\begin{figure}[h]
  \centering
  \includegraphics[width=1\linewidth]{images/hidac-architacture.png}
  \caption{architecture overview of HiDAC,  taken from \cite{pelechano_controlling_2007}}
  \Description{architecture overview of HiDAC}
  \label{fig:hidacArchitecture}
\end{figure}
For better performance and more realistic behavior the model separates the environment into different rooms which are connected by "portals" such as doors. Each agent chooses an attractor point in the room and navigates to it, furthermore the agents only perform collision detection and other forces only to agents in the same room or in case the agent is in area of a portal to other agents in the area of that specific portal.

The goals of the system are the following:
\begin{itemize}
    \item Preventing agents from appearing to vibrate (shaking behavior), which is often seen on social force based systems especially in high density areas or when an agent is in a hurry.
    \item Creating natural bi-directional flow rates, other simulations often lack the behaviour of lane formation which is however observed often in real crowds
    \item Queuing and other organized behavior
    \item Pushing through a crowd
    \item Agents falling and becoming obstacles 
    \item Propagating panic
    \item Exhibiting impatience
    \item Reacting in real time to changes in the environment
\end{itemize}

\subsubsection{solution}
To achieve these goals, the papers presents a detailed calculation based on different forces and tricks. In the following i want to summarise the ideas of the model and calculation. 

As a starting point they define a rectangle of influence for each agent, which is calculated based on the distance and angle to other static and dynamic objects. This allows to optimize performance as only objects in the own rectangle of influence has to be considered to further calculations. 
There are three main forces \textbf{avoidance force, tangential force and repulsion force}. Avoidance force prevents direct collisions with objects it is applied to static objects and other agents. Tangential force happens between agents and is used to control agents in a situation where they run towards each other these are called bi-directional flows. On high density crowds this force allows the simulation to create the realistic behavior of lane formation, which interestingly is not explicitly implemented in the model but results from the applied forces. Lastly the repulsion force is triggered as a result of a collision with a static object like a wall or a other agent. The main difference is that agents, compared to walls, can be pushed away. 

In addition to the forces there are other tricks which allows them to boost their realistic simulation. 
One very important is the \textbf{stopping rule}, based on the personality and current situation an agent may stop moving for a given time before he continues walking toward its attractor, however the agent can still be pushed away. This rule solves the shaking problem which most social force models have, but still allows the realistic pushing forces on agents. 
A similar rule is the \textbf{waiting rule} which allows queues to be formed on non panic situations. Modelling of a different \textbf{personal space} for each agent allows the system to perform pushing each other. 
The systems also allows to simulate an falling agent as static obstacle in the case of a very dense crowd and special behaviour in panic situations. 
The separation into different modules and communication between them allows the low-level module to detect bottlenecks and the high-level to find an alternative path, this is known as \textbf{crowd impatience}. Similar to this, rerouting in the case of a chancing environment works, for example when a door is blocked.

\subsection{vision based system}

"A Synthetic-Vision Based Steering Approach for Crowd Simulation" \cite{ondrej_synthetic-vision_2010} present an approach to control an microscopic simulation without using any forces instead relying purely on predictions based on the view for each agent.
But in comparison to HiDAC where an whole crowd simulation system was described, this approach only focuses on individually walking humans and their collision avoidance behavior. In addition they explicitly do not focus on a high-performance solution however their are some notes on possible performance improvements and benchmarks included. 

The basic idea is that each agent decides on their own visual perception of the environment and other agents if they can continue their path or need to make an adaption by turning or decelerating. Their are similar approaches in the robotics field but these use image processing to get the information needed, their system directly computes the visual image using 3D graphics processing on the GPU.
The method they use does not explicitly check for collision instead it tries to minimize the chance of possible collision. The authors say that their approach using visual perception is better at imitating the real human locomotion control.

\subsubsection{model overview}

The model is based on research from Cutting "How we avoid collisions with stationary and moving objects"(TODO cite), his results on how humans avoid collisions can be broken down to two questions: 
\begin{itemize}
\item Will a collision occur? This is decided by an angle to the obstacle named the bearing angle $\alpha$ . When the derivative of the angle \textbf{\.{$\alpha$}} is zero a collision will occur. Fig\ref{fig:visualBearingangle} visualized the bearing angle and when a collision occurs.
\item When will a collision occur? Using the rate-of-growth for obstacles humans can estimate the \textbf{time-to-collision (ttc)}
\end{itemize}
\begin{figure}[h]
  \centering
  \includegraphics[width=1\linewidth]{images/visualApproach-bearingAngle.png}
  \caption{bearing angle and its time-derivative to detect collisions, taken from \cite{ondrej_synthetic-vision_2010}. The picture in the middle will result in a collision therefore \.{$\alpha$} is zero}
  \Description{bearing angle}
  \label{fig:visualBearingangle}
\end{figure}
The paper changes the use of time-to-collision to time-to-interaction tti, so the time needed before the two participants get closest to another this can be a collision or a just a walk by. So in conclusion the information when and where two agents get the closest to another and if a collision will occur can be described by the pair (\.{$\alpha$}, tti). As a general rule of thumb, turning changes \.{$\alpha$} and deceleration changes tti. 

\subsubsection{implementation of steering and collision avoidance} A simplified version for the algorithm can described as following (for every agent):
\begin{enumerate}
    \item a virtual camera is set up using OpenGL with the view of the agent. Each pixel point represents an perceived point where the calculation is performed. 
    \item based on the rendered image by the camera,the velocity and distance for obstacles and our own velocity we calculate the pair (\.{$\alpha$}, tti) for each perceived point.
    \item When \.{$\alpha$} is below a threshold and $tti > 0$ and also lower than a threshold then a change in direction for this perceived point is necessary. 
    \item the turning and deceleration information for each perceived point is combined into one metric 
    \item updating the position of the agent using the calculated metric
\end{enumerate}

\subsubsection{results}

Fig \ref{fig:visualResults} shows the results from the simulation. The advantage of this approach is the realistic lane formation behaviour as well as correctly handling a circle situation. Smooth animation are generated because deceleration only occurs right before a collision is happening. The simulation shows a visual appealing result however there is no confirmation if these results reflect the reality of crowds.

\begin{figure}[h]
  \centering
  \includegraphics[width=1\linewidth]{images/visualApproach-results.png}
  \caption{results showing the lane formation  and traffic circles behaviour, taken from \cite{ondrej_synthetic-vision_2010}.}
  \Description{results}
  \label{fig:visualResults}
\end{figure}

\subsection{ViCrowd}

The paper "Hierarchical model for real time simulation of virtual human crowds" \cite{musse_hierarchical_2001} presents a crowd simulation system named ViCrowd. 
The goal is to deliver a complete simulation system that can run in real time. 
There are multiple parts that makes this paper interesting and standing out from others in the field, these parts i want to summarize here. 

\subsubsection{multilevel hierarchy}
The model they use is unique because it is a combination of a macroscopic and microscopic model. The goal here is to use the performance advantage of macroscopic models while keeping the advantages of individualism and the resulting realism of microscopic models.
They achieve this by taking the agents and assign them to different groups. As a result there are three complexity levels: (1) the whole crowd, (2) the different groups, (3) the individual agents. Although the assignment to the group is not fixed and an agent can convert to a different group during the simulation, but an agent is only assigned to one group at the same time.

Each level has a different complexity and assigned tasks / calculations. 
The simplest level is the agent level where only a small amount of the movement decisions are made, collision avoidance in the local area is one of them as this can't be done at the group level.
The most influential level is that of the group, here is the most knowledge saved and complex decisions are made, for example path planning.
At the crowd level only information relevant for all groups are stored and processed, foe example interest points of the scene.
The information flow is mostly top to bottom so crowd$\rightarrow$group$\rightarrow$individual.
This separation of levels and complexity allows the system to reduce the number complex tasks and reuse information for multiple individuals at a group level. The simulations gains an huge performance benefit while keeping most of the realistic behaviour of a pure microscopic model. 
\subsubsection{combination of autonomous and scripted behaviour}
ViCrowd provides three ways of handling group behaviour autonomous, guided and programmed. 
Autonomous groups handle all their movement by themselves. Guided groups are controlled from an external controller in real time during the simulation. And programmed groups act at simulation time accordingly to their beforehand provided script. Users can define the crowd or group behaviour using the provided script language, at runtime the system assigns the scripts the to specific groups. 
What is interesting about this approach is that all three methods can be combined even on the same group. For example the user can directly guide a group but the individual agents still handle the collision avoidance. To manage this they implemented a behaviour priority model for the different input methods.
\subsubsection{crowd information}
As basis for decision-making ViCrowd uses three categories of information. Knowledge, beliefs and intentions. 
%%See Fig \ref{fig:hierarchicalInformationOverview} for an overview.
%%
Knowledge is about stored information about the real environment, position of obstacles etc.. 
Belief is a set of behaviour and emotions individuals and groups share, for example flocking behaviour.
Intentions usually are at group and individual level only and consists of goals to achieve, some examples are at group level interesting points and at individual level when to change to a different group.
%%\begin{figure}[h]
%%  \centering
%%  \includegraphics[width=1\linewidth]{images/HierarchicalCrowdInformationOverview.png}
%%  \caption{Overview of used information categories with examples, taken from \cite{musse_hierarchical_2001}.}
%%  \Description{information overview}
%%  \label{fig:hierarchicalInformationOverview}
%%\end{figure}
Fig. \ref{fig:hierarchicalarchitectureOverview} shows an overview of the complete ViCrowd system. The result is a low-level behavior for each group which is distributed to its assigned agents. The resulting pattern for each agent is similar to the other group members, but also includes their own details like local collision avoidance.

\begin{figure}[h]
  \centering
  \includegraphics[width=1\linewidth]{images/HierarchicalArchitectureOverview.png}
  \caption{Overview of the architecture of ViCrowd, taken from \cite{musse_hierarchical_2001}.}
  \Description{architecture of ViCrowd}
  \label{fig:hierarchicalarchitectureOverview}
\end{figure}

%%
%% The acknowledgments section is defined using the "acks" environment
%% (and NOT an unnumbered section). This ensures the proper
%% identification of the section in the article metadata, and the
%% consistent spelling of the heading.
\begin{acks}
To Robert, for the bagels and explaining CMYK and color spaces.
\end{acks}

%%
%% The next two lines define the bibliography style to be used, and
%% the bibliography file.
\bibliographystyle{ACM-Reference-Format}
\bibliography{literaturVerzeichnis}

%%
%% If your work has an appendix, this is the place to put it.
\appendix

\end{document}
\endinput
%%
%% End of file `sample-xelatex.tex'.
